<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-root" content="/intro-to-ml">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="3.5.0.759969491083">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 3.5.0">

    <!-- Primary Meta Tags -->
    <title>End-to-End ML Project</title>
    <meta name="title" content="End-to-End ML Project">
    <meta name="description" content="In this article, we will work through a simple end-to-end ML project based on Chapter 2 of Hands-On Machine learning with Scikit-Learn and TensorFlow">

    <!-- Canonical -->
    <link rel="canonical" href="https://jonivrapi.github.io/intro-to-ml/example-end-to-end-ml-project/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://jonivrapi.github.io/intro-to-ml/example-end-to-end-ml-project/">
    <meta property="og:title" content="End-to-End ML Project">
    <meta property="og:description" content="In this article, we will work through a simple end-to-end ML project based on Chapter 2 of Hands-On Machine learning with Scikit-Learn and TensorFlow">
    <meta property="og:image" content="https://jonivrapi.github.io/intro-to-ml/example-end-to-end-ml-project/images/df-head.jpg">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://jonivrapi.github.io/intro-to-ml/example-end-to-end-ml-project/">
    <meta property="twitter:title" content="End-to-End ML Project">
    <meta property="twitter:description" content="In this article, we will work through a simple end-to-end ML project based on Chapter 2 of Hands-On Machine learning with Scikit-Learn and TensorFlow">
    <meta property="twitter:image" content="https://jonivrapi.github.io/intro-to-ml/example-end-to-end-ml-project/images/df-head.jpg">

    <script data-cfasync="false">(function () { var el = document.documentElement, m = localStorage.getItem("doc_theme"), wm = window.matchMedia; if (m === "dark" || (!m && wm && wm("(prefers-color-scheme: dark)").matches)) { el.classList.add("dark") } else { el.classList.remove("dark") } })();</script>

    <link href="../resources/css/retype.css?v=3.5.0.759969491083" rel="stylesheet">

    <script data-cfasync="false" src="../resources/js/config.js?v=3.5.0.759969491083" data-turbo-eval="false" defer></script>
    <script data-cfasync="false" src="../resources/js/retype.js?v=3.5.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" data-cfasync="false" src="../resources/js/lunr.js?v=3.5.0.759969491083" data-turbo-eval="false" defer></script>
    <script id="prism-js" data-cfasync="false" src="../resources/js/prism.js?v=3.5.0.759969491083" defer></script>
    <link href="../resources/css/katex.css?v=3.5.0" rel="stylesheet">
    <script id="katex-js" data-cfasync="false" src="../resources/js/katex.js?v=3.5.0" defer></script>
</head>
<body>
    <div id="docs-app" class="relative text-base antialiased text-gray-700 bg-white font-body dark:bg-dark-850 dark:text-dark-300">
        <div class="absolute bottom-0 left-0 bg-gray-100 dark:bg-dark-800" style="top: 5rem; right: 50%"></div>
    
        <header id="docs-site-header" class="sticky top-0 z-30 flex w-full h-16 bg-white border-b border-gray-200 md:h-20 dark:bg-dark-850 dark:border-dark-650">
            <div class="container relative flex items-center justify-between pr-6 grow md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton docs-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="docs-sidebar-toggle"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="docs-site-logo" href="../" class="flex items-center leading-snug text-2xl">
                            <span class="dark:text-white font-semibold line-clamp-1 md:line-clamp-2">ML</span>
                        </a><span class="hidden px-2 py-1 ml-4 text-sm font-semibold leading-none text-root-logo-label-text bg-root-logo-label-bg rounded-sm md:inline-block">Docs</span>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block dark:border-dark-650"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://retype.com/guides/getting-started/">Getting Started</a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
                            <input class="w-full h-10 placeholder-gray-400 transition-colors duration-200 ease-in bg-gray-200 border border-transparent rounded md:text-sm hover:bg-white hover:border-gray-300 focus:outline-none focus:bg-white focus:border-gray-500 dark:bg-dark-600 dark:border-dark-600 dark:placeholder-dark-400" style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search">
                        </div>
        
                        <!-- Mobile search button -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placeholder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="docs-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
        <div class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-gray-100 border-gray-200 sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton dark:bg-dark-800 dark:border-dark-650">
            
                <!-- Render this div, if config.showSidebarFilter is `true` -->
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-white border border-gray-200 rounded shadow-none text-sm focus:outline-none focus:border-gray-600 dark:bg-dark-600 dark:border-dark-600" type="text" placeholder="Filter">
                </div>
            
                <div class="pl-6 mt-1 mb-4">
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                </div>
            
                <div class="shrink-0 mt-auto bg-transparent dark:border-dark-650">
                    <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                        <span class="text-xs whitespace-nowrap">Powered by</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                    </a>
                </div>
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-dark-650">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-dark-650">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://retype.com/guides/getting-started/">Getting Started</a>
                                    </li>
            
                                </ul>
                            </nav>
                        </div>
            
                        <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                            <span class="text-xs whitespace-nowrap">Powered by</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                        </a>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 dark:bg-dark-850">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div class="min-w-0 p-4 grow md:px-16">
                        <main class="relative pb-12 lg:pt-2">
                            <div class="docs-markdown" id="docs-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="docs-sidebar-right-toggle"></div>
                                <!-- Page content  -->
<doc-anchor-target id="end-to-end-ml-project" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#end-to-end-ml-project">#</doc-anchor-trigger>
        <span>End-to-End ML Project</span>
    </h1>
</doc-anchor-target>
<p>In this article, we will work through a simple end-to-end ML project based on Chapter 2 of <em>Hands-On Machine learning with Scikit-Learn and TensorFlow</em> by Aurélien Géron to give you a taste for how this works in practice. It will closely follow the following structure:</p>
<ol>
<li>Frame the Problem</li>
<li>Choosing a Performance Measure</li>
<li>Analyze the data to gain insights about the problem</li>
<li>Preprocess the data for ML</li>
<li>Choose a model to test</li>
<li>Train the model</li>
<li>Evaluate the model</li>
</ol>
<doc-anchor-target id="california-housing-data">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#california-housing-data">#</doc-anchor-trigger>
        <span>California Housing Data</span>
    </h3>
</doc-anchor-target>
<p>While there are many toy datasets that you can play with to practice your ML skill set, it is always best to try and work with real data as this is more representative of what you will have to deal with in your day job. Data is never clean, always hard to find, and almost never complete. With that in mind, we will be using the California Housing Prices dataset which you can download here:</p>
<p>
<div class="mb-6 px-5 py-4 flex justify-between relative border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded transition-colors duration-150">
    <div class="flex items-center text-blue-500 dark:text-blue-400">
        <span class="inline-block mb-px">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" role="presentation" fill="currentColor"><path fill="none" d="M0 0h24v24H0z"/><path d="M21 14c-.55 0-1 .45-1 1v4c0 .55-.45 1-1 1H5c-.55 0-1-.45-1-1v-4c0-.55-.45-1-1-1s-1 .45-1 1v4c0 1.65 1.35 3 3 3h14c1.65 0 3-1.35 3-3v-4c0-.55-.45-1-1-1z"/><path d="M11.29 15.71c.09.09.2.17.33.22.12.04.25.07.38.07s.26-.03.38-.08.23-.12.33-.22l5-5a.996.996 0 10-1.41-1.41l-3.3 3.3V3c0-.55-.45-1-1-1s-1 .45-1 1v9.59l-3.29-3.3A.996.996 0 106.3 10.7l4.99 5.01z"/></svg>
        </span>
        <span class="inline-block font-medium ml-2">housing.csv</span>
    </div>
    <div class="flex items-center text-xs text-gray-400 dark:text-dark-400">
        <span>housing.csv</span>
        <span class="inline-block ml-2">1.36MB</span>
    </div>
    <a href="datasets/housing.csv" class="absolute block inset-0" target="_blank" download="housing.csv"></a>
</div>
</p>
<p>This dataset comes from <a href="https://www.kaggle.com/datasets/camnugent/california-housing-prices?resource=download">Kaggle</a> and has the following explanation:</p>
<blockquote>
<p><strong>Context</strong></p>
<p>This is the dataset used in the second chapter of Aurélien Géron&#x27;s recent book &#x27;Hands-On Machine learning with Scikit-Learn and TensorFlow&#x27;. It serves as an excellent introduction to implementing machine learning algorithms because it requires rudimentary data cleaning, has an easily understandable list of variables and sits at an optimal size between being to toyish and too cumbersome.</p>
<p>The data contains information from the 1990 California census. So although it may not help you with predicting current housing prices like the Zillow Zestimate dataset, it does provide an accessible introductory dataset for teaching people about the basics of machine learning.</p>
<p><strong>Content</strong></p>
<p>The data pertains to the houses found in a given California district and some summary stats about them based on the 1990 census data. Be warned the data aren&#x27;t cleaned so there are some preprocessing steps required! The columns are as follows, their names are pretty self explanitory:</p>
<p>longitude</p>
<p>latitude</p>
<p>housing_median_age</p>
<p>total_rooms</p>
<p>total_bedrooms</p>
<p>population</p>
<p>households</p>
<p>median_income</p>
<p>median_house_value</p>
<p>ocean_proximity</p>
</blockquote>
<p>The purpose of this project is to ultimately end up with a model that is able to predict the median house price in any district, give all the other metrics.</p>
<doc-anchor-target id="framing-the-problem">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#framing-the-problem">#</doc-anchor-trigger>
        <span>Framing the Problem</span>
    </h3>
</doc-anchor-target>
<p>The first thing you should do is to ask what the business objective is. This will determine many facets of how you approach the problem, such as which performance measures you choose, which algorithms you select, and how much time you will spend optimizing hyperparameters.</p>
<p>After asking how the model is expected to be used, you are told that this model&#x27;s output is expected to be fed into another ML system as one signal among many, whose purpose is to predict whether it is worth investing in a given area or not. Cool.</p>
<p>The next question you may ask would be how this process is currently done. You determine that the process is currently manual, and a team of SME&#x27;s gathers the most recent information about a district, and then uses a complex rule-set to estimate a price. This takes a huge amount of time, and the estimates are mediocre.</p>
<p>Now, given what you have read in previous sections, is this a supervised, unsupervised, or RL problem? Is it a Classification task, or a Regression task? Upon looking at the explanation of the data above, you can see that the median house value is present, making this a textbook supervised learning task. In addition, since you are attempting to predict a continuous value, it is a regression task. Finally, since we are using multiple features to predict this continuous value, it is a <em>multiple</em> regression task. Finally, since we are only trying to predict a single value, it will be a <em>univariate regression</em> problem.</p>
<doc-anchor-target id="selecting-a-performance-measure">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#selecting-a-performance-measure">#</doc-anchor-trigger>
        <span>Selecting a Performance Measure</span>
    </h3>
</doc-anchor-target>
<p>A typical performance measure for regression problems is the Root Mean Squared Error (RMSE). This is a way, as with the Mean Absolute Error (MAE), to measure the distance between two vectors -- in our case, the vector of predictions and the vector of target values. It is defined as follows:</p>
<div class="math"><pre>    RMSE(\mathbf{X}, h) = \sqrt{\frac{1}{m} \sum_{i=1}^{m} h( \mathbf{x^{(i)}} - y^{(i)} )^2}</pre></div>
<p>Where</p>
<ul>
<li><span class="math">m</span> is the number of instances in your dataset that you are measuring RMSE on</li>
<li><span class="math">\mathbf{x^{(i)}}</span> is the vector of all feature values excluding the label of the $i$th instance (row) in the dataset</li>
<li><span class="math">y^{(i)}</span> is <span class="math">x^{(i)}</span>&#x27;th&#x27;s label</li>
<li><span class="math">h</span> is your system&#x27;s prediction function, also called your <em>hypothesis</em>. If given <span class="math">\mathbf{x^{(i)}}</span> it outputs <span class="math">\hat{y^{(i)}} = h(\mathbf{x^{(i)}})</span>.</li>
</ul>
<p>RMSE corresponds to the <em>Euclidean norm</em>, and is also referred to as the <span class="math">L_2</span> norm and is denoted as <span class="math">\|x\|_2</span>. MAE corresponds to the <em>Manhattan norm</em> and is referred to as the <span class="math">L_1</span> norm and denoted <span class="math">\|x\|_1</span>.</p>
<doc-anchor-target id="getting-the-data">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#getting-the-data">#</doc-anchor-trigger>
        <span>Getting the data</span>
    </h3>
</doc-anchor-target>
<p>In our case, you will get the data from here:</p>
<p>
<div class="mb-6 px-5 py-4 flex justify-between relative border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded transition-colors duration-150">
    <div class="flex items-center text-blue-500 dark:text-blue-400">
        <span class="inline-block mb-px">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" role="presentation" fill="currentColor"><path fill="none" d="M0 0h24v24H0z"/><path d="M21 14c-.55 0-1 .45-1 1v4c0 .55-.45 1-1 1H5c-.55 0-1-.45-1-1v-4c0-.55-.45-1-1-1s-1 .45-1 1v4c0 1.65 1.35 3 3 3h14c1.65 0 3-1.35 3-3v-4c0-.55-.45-1-1-1z"/><path d="M11.29 15.71c.09.09.2.17.33.22.12.04.25.07.38.07s.26-.03.38-.08.23-.12.33-.22l5-5a.996.996 0 10-1.41-1.41l-3.3 3.3V3c0-.55-.45-1-1-1s-1 .45-1 1v9.59l-3.29-3.3A.996.996 0 106.3 10.7l4.99 5.01z"/></svg>
        </span>
        <span class="inline-block font-medium ml-2">housing.csv</span>
    </div>
    <div class="flex items-center text-xs text-gray-400 dark:text-dark-400">
        <span>housing.csv</span>
        <span class="inline-block ml-2">1.36MB</span>
    </div>
    <a href="datasets/housing.csv" class="absolute block inset-0" target="_blank" download="housing.csv"></a>
</div>
</p>
<doc-anchor-target id="analyze-the-data">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#analyze-the-data">#</doc-anchor-trigger>
        <span>Analyze the data</span>
    </h3>
</doc-anchor-target>
<p>Next, we will perform some analysis of the data so that we can get a better handle on it. This part of the ML development process is extremely important as it is where you will garner the vast majority of insights you develop from working with your dataset. This will help inform your model development later on.</p>
<p>Let&#x27;s begin by doing a sanity check of our data.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">import pandas as pd

df = pd.read_csv('housing.csv')

df.head(10)</code></pre>
</doc-codeblock></div>
<p><figure class="content-center">
    <img src="images/df-head.jpg" alt="">
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>Next, let&#x27;s try and get an understanding of how much data we have, and how much of it may be missing.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">df.info()</code></pre>
</doc-codeblock></div>
<p><figure class="content-center">
    <img src="images/df-info.jpg" alt="">
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>Here you will notice that there are 20,640 total observations in the dataset, and that all columns except for <code v-pre>total_bedrooms</code> have 20,640 rows. <code v-pre>total_bedrooms</code> seems to be missing 207 values...which we will handle later. Another important thing to notice here is that all values are numerical, except for <code v-pre>ocean_proximity</code> which is of type <code v-pre>object</code> (in this case a string). It is therefore a categorical feature, and you can inspect the categories and their counts like so:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">df['ocean_proximity'].value_counts()</code></pre>
</doc-codeblock></div>
<p><figure class="content-center">
    <img src="images/ocean_proximity-value-counts.jpg" alt="">
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>Finally, another useful thing to do is to plot your numerical values with a histogram. This can help to visually reveal the distributions and scales of your numerical features which can inform preprocessing steps and model selection down the line.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">%matplotlib inline

import matplotlib.pyplot as plt
df.hist(bins=50, figsize=(20, 15))
plt.show()</code></pre>
</doc-codeblock></div>
<p><figure class="content-center">
    <img src="images/histogram.jpg" alt="">
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>You may notice here that many of your features are on different scales. This is also a problem that we will handle later on. Many models require that your input features be on the same scale lest they potentially may learn that one feature is more important than another, simply because its values are larger.</p>
<doc-anchor-target id="further-data-exploration">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#further-data-exploration">#</doc-anchor-trigger>
        <span>Further Data Exploration</span>
    </h3>
</doc-anchor-target>
<p>We did a basic exploration of the data earlier on this page, and will follow up with slightly more here. The purpose of this section is to keep this whole process as simple as possible to give you an idea for how you might approach things, but remember that there are a LOT of things you can do to explore your data to look for patterns.</p>
<p>The following is an example of how to create a correlation matrix so you are able to see how correlated your features are. This only works with numerical features and for brevity&#x27;s sake, we excluded the categorical features. There are, however, many ways to handle categorical features will be discussed in a future section.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">import seaborn as sns
import matplotlib.pyplot as plt
import numpy as np

numeric_data = df.select_dtypes(include=[np.number])
correlation_matrix = numeric_data.corr()

sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm')
plt.show()</code></pre>
</doc-codeblock></div>
<p><figure class="content-center">
    <img src="images/corr-matrix.jpg" alt="">
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>In reading this chart, a value of <code v-pre>1</code> indicates a perfect correlation, a value of <code v-pre>0</code> indicates no correlation, and a value of <code v-pre>-1</code> indicates a perfect negative correlation. Reading this chart, we can see that there is a high correlation between <code v-pre>total_rooms</code> and <code v-pre>total_bedrooms</code> (which makes sense) as well as between <code v-pre>total_rooms</code> and <code v-pre>households</code> and <code v-pre>population</code>. Likewise, there is a high correlation between <code v-pre>households</code> and <code v-pre>population</code>. The rest of the numerical features seem to have insignificant correlations. Finally, we can also see that <code v-pre>median_income</code> is pretty highly correlated to <code v-pre>median_house_value</code> (which is our target). Now, what are you to do with this information?</p>
<p>Well, highly correlated variables can help guide you in your feature selection process. You do not typically want to use many very highly correlated features together as they can reduce the performance of regression models due to multicollinearity. By dropping some of these features, you also may be able to improve a model&#x27;s predictive performance as well as its compute performance. When features are highly correlated with your target variable, however, this is an indication that they may hold good predictive power. Remember that this matrix is only showing <em>linear</em> correlations. It completely ignores non-linear relationships which are powerful as well.</p>
<doc-anchor-target id="handling-missing-values">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#handling-missing-values">#</doc-anchor-trigger>
        <span>Handling Missing Values</span>
    </h3>
</doc-anchor-target>
<p>Next, in order to prep our data for the model, we should first handle any missing values. Let&#x27;s check if there are any first by reviewing the dataframe info output <doc-anchor-trigger to="#analyze-the-data">here</doc-anchor-trigger>. You will notice that <code v-pre>total_bedrooms</code> seems to have 217 rows with missing values. One way to handle this is to <em>impute</em> missing values. You can impute missing values in a whole host of different ways, the simplest of which are just to fill them with the mean or median of the values in the column. In thinking about the field <code v-pre>total_bedrooms</code>, would the median or the mean be the best solution for imputing missing values here? Considering the mean would likely be a floating point number, and that 3.25 bedrooms doesn&#x27;t make sense, the median is likely the better option here. Lets see what that looks like:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">from sklearn.impute import SimpleImputer

imputer = SimpleImputer(strategy='median')
imputer.fit(X_train)

X_train_imputed = imputer.transform(X_train)
X_test_imputed = imputer.transform(X_test) # for use later

imputed_df = pd.DataFrame(X_train_imputed, columns=X_train.columns)

imputed_df.sample(10)</code></pre>
</doc-codeblock></div>
<p><figure class="content-center">
    <img src="images/after-imputing-median.jpg" alt="">
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>Here, we instantiate a <code v-pre>SimpleImputer</code> and give it a strategy. We then fit this imputer and use it to transform the training and testing dataframes to impute the missing values. Finally, as the result of the <code v-pre>transform</code> is a <code v-pre>numpy</code> array, we convert it back to a dataframe for easier viewing and manipulation. We can now sanity-check that we did, in fact, solve our nulls issue by rerunning the info command.</p>
<blockquote>
<p>Note: It is important to remember that you can only fit the scalars, or any kind of transformation, to the training set in order to prevent <em>data leakage</em>.</p>
</blockquote>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">imputed_df.info()</code></pre>
</doc-codeblock></div>
<p><figure class="content-center">
    <img src="images/after-imputation-df-info.jpg" alt="">
    <figcaption class="caption"></figcaption>
</figure>
</p>
<doc-anchor-target id="training-a-model">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#training-a-model">#</doc-anchor-trigger>
        <span>Training a Model</span>
    </h1>
</doc-anchor-target>
<p>The first step in training a model is of course selecting the model. To keep things simple, here we will choose a simple <code v-pre>LinearRegression</code> model from <code v-pre>sklearn</code>.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error

regressor = LinearRegression()
regressor.fit(X_train_imputed, y_train)

predictions = regressor.predict(X_test_imputed)

mse = mean_squared_error(y_test, predictions)
rmse = np.sqrt(mse)

print(f&quot;This model's predictions are off by ${rmse:.2f}&quot;)</code></pre>
</doc-codeblock></div>
<p><figure class="content-center">
    <img src="images/final-rmse.jpg" alt="">
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>We fit the model to our training data, then made predictions on our test data, then evaluated those predictions with our chosen performance measure, and achieved a model which is off by about $71,000 per housing price prediction. This is obviously not good, but for our first end-to-end ML project, not bad!</p>

                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results></doc-toolbar-member-filter-no-results>
                            </div>
                            <footer class="clear-both">
                            
                                <nav class="flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../fundamentals-of-ml/mathematical-concepts/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-gray-400 dark:text-dark-400">Previous</span>
                                                <span class="block mt-1">Math Concepts</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-r-lg transition-colors duration-150 relative hover:z-5" href="../assignments/assignment-1/">
                                            <span>
                                                <span class="block text-xs font-normal text-right text-gray-400 dark:text-dark-400">Next</span>
                                                <span class="block mt-1">Assignment 1</span>
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        </a>
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div class="border-t dark:border-dark-650 pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between">
                                <div>
                                    <ul class="flex flex-wrap items-center text-sm">
                                    </ul>
                                </div>
                                <div class="docs-copyright py-2 text-gray-500 dark:text-dark-350 text-sm leading-relaxed"><p>© Copyright 2024. All rights reserved.</p></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-white border-gray-200 lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton dark:bg-dark-850 dark:border-dark-650">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="docs-overlay-target"></div>

    <script data-cfasync="false">window.__DOCS__ = { "title": "End-to-End ML Project", level: 1, icon: "file", hasPrism: true, hasMermaid: false, hasMath: true, tocDepth: 23 }</script>
</body>
</html>
